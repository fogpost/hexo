name: Hexo Deploy

permissions:
  contents: write  # å…è®¸æ’ä»¶æ¨é€åˆ°ä½ çš„ web åˆ†æ”¯

on:
  push:
    branches:
      - main

jobs:
  deploy:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: 20

      - name: Install dependencies
        run: |
          cd blog
          npm install

      - name: Build Hexo
        run: |
          cd blog
          npx hexo clean
          npx hexo generate
          # åœ¨ç”Ÿæˆçš„é™æ€æ–‡ä»¶æ ¹ç›®å½•ç”Ÿæˆè¿™ä¸¤ä¸ªå…³é”®æ–‡ä»¶
        #   touch public/.nojekyll
        #   echo "ä½ çš„åŸŸå.com" > public/CNAME  # ğŸ‘ˆ è¿™é‡Œå¡«å…¥ä½ çš„çœŸå®åŸŸå

      - name: Deploy to Web Branch
        uses: peaceiris/actions-gh-pages@v3
        with:
          github_token: ${{ secrets.GITHUB_TOKEN }} # ä½¿ç”¨å†…ç½® Token å³å¯ï¼Œæ— éœ€æ‰‹åŠ¨é…ç½® PAT
          publish_dir: ./blog/public               # ğŸ‘ˆ åªå‘å¸ƒè¿™ä¸ªç›®å½•ä¸‹çš„å†…å®¹
          publish_branch: web                      # ğŸ‘ˆ å‘å¸ƒåˆ° web åˆ†æ”¯
          force_modify: true                       # å¼ºåˆ¶è¦†ç›–