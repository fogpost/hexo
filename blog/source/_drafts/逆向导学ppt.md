---
title: é€†å‘ppt
date: 2026-01-19T18:49:00
tags:
  - ctf
updated: 2026-01-26T20:27:58+08:00
---
# å¼€ç¯‡æƒ³è¯´çš„è¯
æˆ‘å»åˆšåˆšå‡†å¤‡å†™pptçš„æ—¶å€™å‘ç°æˆ‘obsidianæ²¡æœ‰é‡å‘½åå’Œè‡ªåŠ¨åŒ–åˆ›å»ºæ ‡ç­¾çš„åŠŸèƒ½ï¼Œä¸è¿‡è¿˜å¥½ç¤¾åŒºçš„templateå’Œquickaddç»™æˆ‘ä»¬æå‡ºäº†è§£å†³åŠæ³•ï¼Œä¸è¿‡ç°åœ¨è¿˜æ˜¯å…ˆæ¥å¥½å¥½å†™æˆ‘ä»¬çš„pptå§ï¼Œä¸‹åˆæœ¬æ¥ä¸‰ç‚¹ä¸­æƒ³å†™çš„ä¸è¿‡ç¡äº†ä¸€è§‰å°±åˆ°6ç‚¹äº†ğŸ¤­ã€‚ä¹‹åè¿˜è¦å†™æ¯•è®¾å‘¢ï¼Œä¸ç„¶è„‘è¢‹ç—›
é€†å‘å¯¼å­¦æ‰“ç®—æŒ‰ç…§æ¥ä¸‹æ¥è¿™å››ä¸ªæ–¹é¢å†™å¥½ï¼Œæ„Ÿè§‰è¿™ä¹ˆå¤šå½“å¯¼å­¦éƒ½45minè®²ä¸å®Œã€‚

- CTF é€†å‘åœ¨â€œé€†â€ä»€ä¹ˆï¼ˆå…¥é—¨è®¤çŸ¥ + å·¥å…·ï¼‰
- æ±‡ç¼–ä¸æ˜¯æ•Œäººï¼ˆé€†å‘æ ¸å¿ƒèƒ½åŠ›ï¼‰
- åŠ¨æ€è°ƒè¯• = é€†å‘ä½œå¼Šå™¨
- CTF å¸¸è§å¥—è·¯æ€»ç»“ + è¿›é˜¶æŒ‡è·¯


```
æœ¬èŠ‚è¯¾å‰æä¸‹è½½å¥½ç¾¤å†…ä¸‹å‘çš„reverseæ–‡ä»¶
æå‰ä¸‹å¥½python
```
# CTF é€†å‘åœ¨â€œé€†â€ä»€ä¹ˆï¼ˆå…¥é—¨è®¤çŸ¥ + å·¥å…·ï¼‰
ä¸€å¥è¯è§£é‡Šå°±æ˜¯CTFé€†å‘å°±æ˜¯åœ¨é™æ€ç¨‹åºä¸­è·å–flagçš„æ£€æŸ¥é€»è¾‘ï¼Œç„¶ååˆ©ç”¨è·å–é€»è¾‘åæ¨å‡ºé€†å‘çš„flagã€‚
## å¸¸è§çš„CTFå½¢æ€
- crackme/flagæ ¡éªŒ
- ç®—æ³•è¿˜åŸï¼ˆbase / xor / crc / è‡ªå®šä¹‰ hashï¼‰
- ç®€å• VM / èŠ±æŒ‡ä»¤ï¼ˆç‚¹åˆ°ä¸ºæ­¢ï¼‰
## å·¥å…·ï¼ˆWindowsæ–¹å‘ï¼‰
åˆå­¦è€…è¦äº†è§£çš„ä¸»è¦æ˜¯å·¥å…·çš„ç§ç±»å’Œç”¨æ³•ï¼ŒåŒwebå·¥å…·è€Œè¨€ï¼Œé€†å‘ä¹Ÿæœ‰ä»¥ä¸‹å‡ ä¸ªæ­¥éª¤ï¼Œæˆ‘é¡ºå¸¦å°†å„ä¸ªæµç¨‹å·¥å…·å†™ä¸Š
- ä¿¡æ¯æ”¶é›†ã€‚ï¼ˆIDEï¼ŒPEinfoï¼‰
IDE
![image.png](https://gitee.com/fogpost/photo/raw/master/202601221717345.png) 
PEinfo
![image.png](https://gitee.com/fogpost/photo/raw/master/202601221717988.png)

- é™æ€ï¼š
    - IDA / Ghidraï¼ˆå‡½æ•°ã€å­—ç¬¦ä¸²ã€äº¤å‰å¼•ç”¨ï¼‰
- åŠ¨æ€ï¼š
    - x64dbgï¼ˆWindowsï¼‰
    - gdb + pwndbgï¼ˆLinuxï¼‰

æˆ‘ä»¬Windowsç”µè„‘ä¸»è¦ç”¨çš„å°±æ˜¯idaå’Œx64çš„ç»„åˆï¼Œx64æœ‰å¾ˆå¤šæ’ä»¶ç°åœ¨æ–‡ä»¶ä¸­çš„æ˜¯çº¯å‡€ç‰ˆ
ç›®å‰ç”¨åˆ°çš„ä¸»è¦åŠŸèƒ½
- Strings
- main / WinMain
- å‡½æ•°è°ƒç”¨å…³ç³»ï¼Œç›¸äº’å¼•ç”¨
- ä¸‹æ–­ç‚¹ / å•æ­¥ / çœ‹å¯„å­˜å™¨

# æ±‡ç¼–ä¸æ˜¯æ•Œäººï¼ˆé€†å‘æ ¸å¿ƒèƒ½åŠ›ï¼‰
æ±‡ç¼–è¿™ä¸ªä¸œè¥¿ç›®å‰æ¥è¯´å°±8086æ±‡ç¼–åé¢çš„win32æ±‡ç¼–å’Œarmæ±‡ç¼–éƒ½å¯æ”¾åé¢ä¸€ç‚¹ï¼ˆæˆ‘æ€ä¹ˆæ€»è®°å¾—è¿˜æœ‰ä¸€ä¸ªå’Œ8086ä¸ä¸€æ ·çš„intæ±‡ç¼–ï¼Œä½†æ˜¯è¿™ä¸æ˜¯ä¸€å®¶çš„ä¹ˆï¼‰æ±‡ç¼–æ˜¯ä¸€ç§è½¯ä»¶åˆ†æå·¥å…·æ”»å‡»
## å¿…é¡»ä¼šçš„æ±‡ç¼–
- x86/x64 åŸºç¡€
- å¸¸è§æŒ‡ä»¤ï¼š
    - mov / lea / cmp / jmp / call / test æ±‡ç¼–æŒ‡ä»¤
    - eax/ebx/ecx/edx åŸºæœ¬å¯„å­˜å™¨

>**RAX**ï¼š**â€œè¿”å›å€¼ä¹‹ç‹â€**ã€‚å‡½æ•°æ‰§è¡Œå®Œåçš„ç»“æœï¼ˆæ¯”å¦‚ `compare` çš„ç»“æœ `0`ï¼‰æ°¸è¿œæ”¾åœ¨è¿™é‡Œ
>RIPï¼šâ€œæŒ‡æŒ¥æ£’â€ã€‚æŒ‡å‘ä¸‹ä¸€æ¡è¦æ‰§è¡Œçš„æŒ‡ä»¤åœ°å€ã€‚å¦‚æœä½ ä¿®æ”¹äº†å®ƒï¼Œå°±èƒ½æ§åˆ¶ç¨‹åºè·³è½¬åˆ°ä»»ä½•åœ°æ–¹ã€‚
>RCX, RDX, R8, R9ï¼šâ€œä¼ å‚å››å¤§å¤©ç‹â€ã€‚åœ¨ Windows x64 ä¸‹ï¼Œå‡½æ•°çš„å‰å››ä¸ªå‚æ•°ç›´æ¥è£…åœ¨è¿™å››ä¸ªå¯„å­˜å™¨é‡Œå¾€å‡½æ•°é‡Œé€ã€‚
>RSPï¼šâ€œæ ˆé¡¶æŒ‡é’ˆâ€ã€‚æ°¸è¿œæŒ‡å‘å½“å‰â€œå‚¨ç‰©é—´â€çš„æœ€é¡¶å±‚ã€‚
![image.png](https://gitee.com/fogpost/photo/raw/master/202601252033095.png)


```c
mov eax, 1        ; eax = 1
mov ebx, eax      ; ebx = eax
mov eax, [ebp-4]  ; ä»å†…å­˜è¯»åˆ°å¯„å­˜å™¨
mov [ebp-8], eax  ; ä»å¯„å­˜å™¨å†™åˆ°å†…å­˜

lea eax, [ebp-4]      ; eax = &var
lea eax, [eax+4]      ; eax = eax + 4
lea eax, [eax*2+10]   ; eax = eax*2 + 10

cmp eax, 5
cmp eax, ebx
cmp [ebp-4], 0

jmp 0x401000
jmp short loc_123

call 0x401050
call eax

test eax, eax
test al, 1
```

åŸºç¡€çš„strcmp
```c
; å‡è®¾ RCX æŒ‡å‘ str1, RDX æŒ‡å‘ str2
lea     rdx, [rbp+var_str2]    ; å°†ç”¨æˆ·è¾“å…¥çš„åœ°å€ä¼ ç»™ RDX
lea     rcx, [rbp+var_str1]    ; å°†é¢„è®¾ Flag çš„åœ°å€ä¼ ç»™ RCX
call    std::string::compare   ; è°ƒç”¨æ¯”è¾ƒå‡½æ•°
mov     [rbp+var_result], eax  ; å°†è¿”å›å€¼å­˜å…¥ result å˜é‡

; --- æ ¸å¿ƒæ ¡éªŒé€»è¾‘ ---
cmp     [rbp+var_result], 0    ; æ¯”è¾ƒç»“æœæ˜¯å¦ä¸º 0
jne     short loc_error_path   ; å¦‚æœä¸ç­‰äº 0 (Jump if Not Equal)ï¼Œè·³åˆ°é”™è¯¯æç¤º

; --- æ­£ç¡®è·¯å¾„ ---
lea     rcx, offset aCorrect   ; "Correct! You find the flag"
call    std::cout::operator<<
jmp     short loc_exit

loc_error_path:
lea     rcx, offset aTryIda    ; "Try the ida or dbg"
call    std::cout::operator<<
```
F5ä¼ªä»£ç 
```c
int __cdecl main() {
  // å±€éƒ¨å˜é‡å£°æ˜
  char str1[32]; 
  char str2[32];
  int result;

  // 1. åˆå§‹åŒ–å­—ç¬¦ä¸²
  std::string::string(str1, "Flag{example_strcmp}");
  
  // 2. è·å–è¾“å…¥
  std::cout << "Enter the flag: ";
  std::getline(&std::cin, str2);

  // 3. æ¯”è¾ƒé€»è¾‘
  result = std::string::compare(str1, str2);

  // 4. åˆ†æ”¯åˆ¤æ–­
  if ( result == 0 ) {
    std::cout << "Correct! You find the flag" << "\n";
  } else {
    std::cout << "Try the ida or dbg" << "\n";
  }

  return 0;
}
```
- æ ˆã€å¯„å­˜å™¨ã€å‡½æ•°è°ƒç”¨
## ä¸¾ä¾‹ä» C â†’ æ±‡ç¼– â†’ åç¼–è¯‘

ä¸¾ä¾‹ï¼š
```c++
Â  Â  // è¿™æ˜¯ "Flag{Hello_CTF}" æ¯ä¸ªå­—ç¬¦å¼‚æˆ– 0x55 åçš„ç»“æœ
Â  Â  // è¿™æ ·ç”¨æˆ·è¾“å…¥æ­£å¸¸çš„ Flag{...}ï¼Œç¨‹åºå†…éƒ¨å¼‚æˆ–åå»å¯¹æ¯”è¿™äº›â€œä¹±ç â€
Â  Â  unsigned char cipher[] = {
Â  Â  Â  Â  0x13,0x39,0x34,0x32,0x2e,0x1d,0x30,0x39,
Â  Â  Â  Â  0x39,0x3a,0x0a,0x16,0x01,0x13,0x28
Â  Â  };
Â  Â  string in;
Â  Â  cout << "Enter Flag: ";
Â  Â  cin >> in;
Â  Â  if (in.length() != sizeof(cipher)) return 0;
Â  Â  for (int i = 0; i < in.length(); i++) {
Â  Â  Â  Â  // ç”¨æˆ·è¾“å…¥å¯è§å­—ç¬¦ (å¦‚ 'F')ï¼Œå¼‚æˆ– 0x55 åä¸å¯†æ–‡å¯¹æ¯”
Â  Â  Â  Â  if ((unsigned char)(in[i] ^ 0x55) != cipher[i]) {
Â  Â  Â  Â  Â  Â  cout << "Wrong!" << endl;
Â  Â  Â  Â  Â  Â  return 0;
Â  Â  Â  Â  }
Â  Â  }
Â  Â  cout << "Correct!" << endl;
```
 åœ¨ IDA é‡Œå¯¹åº”å“ªå‡ è¡Œï¼Ÿ
åˆ©ç”¨F5å¯ä»¥çœ‹åˆ°ä¸»å‡½æ•°çš„ä¼ªä»£ç 
![image.png](https://gitee.com/fogpost/photo/raw/master/202601221715777.png)

 æ€ä¹ˆä¸€çœ¼çœ‹å‡ºè¿™æ˜¯ XOR æ ¡éªŒï¼Ÿ
![image.png](https://gitee.com/fogpost/photo/raw/master/202601221640600.png)
###  å®æˆ˜å°é¢˜
- xor + for å¾ªç¯
- flag å­˜åœ¨ cipher æ®µ
- è½»åº¦åç¼–è¯‘å³å¯è¿˜åŸ
```python
cipher=[0x13,0x39,0x34,0x32,0x2e,0x1d,0x30,0x39,0x39,0x3a,0x0a,0x16,0x01,0x13,0x28]
for i in cipher:
Â  Â  print(chr(i^0x55),end="")
```
---

# ç¬¬ä¸‰ç« ï¼šåŠ¨æ€è°ƒè¯• = é€†å‘ä½œå¼Šå™¨

> ç›®æ ‡ï¼š**æ•™ä»–ä»¬â€œå·æ‡’â€è€Œä¸æ˜¯ç¡¬çœ‹**
---
###  ä¸ºä»€ä¹ˆè¦è°ƒè¯•

- åç¼–è¯‘çœ‹ä¸æ‡‚
- ç®—æ³•å¤ªç»•
- æœ‰åè°ƒè¯• / èŠ±æŒ‡ä»¤
---
###  åŠ¨æ€è°ƒè¯•æ ¸å¿ƒæŠ€å·§
- ä¸‹æ–­ç‚¹ï¼š
    - strcmp
    - æ ¡éªŒå‡½æ•°å…¥å£
- å•æ­¥è·Ÿ
- çœ‹å¯„å­˜å™¨ / å†…å­˜
- æ¡ä»¶è·³è½¬è§‚å¯Ÿ

###  ç»å…¸éªšæ“ä½œ
- ç›´æ¥ä¿®æ”¹å¯„å­˜å™¨
- patch æ‰ jnz / jz
- æ”¹è¿”å›å€¼
---
# ç¬¬å››ç« ï¼šCTF å¸¸è§å¥—è·¯æ€»ç»“ + è¿›é˜¶æŒ‡è·¯

### è§£é¢˜æµç¨‹æ¨¡æ¿

ç»™ä»–ä»¬ä¸€ä¸ª**æ ‡å‡† checklist**ï¼š
1. strings
2. æ‰¾ main
3. æ‰¾è¾“å…¥
4. æ‰¾æ ¡éªŒ
5. é™æ€ or åŠ¨æ€
6. å†™è„šæœ¬è¿˜åŸ
---
### å¸¸è§è¯¯åŒº
- æ­»ç£•æ±‡ç¼–
- ä¸ä¸‹æ–­ç‚¹
- ä¸åˆ©ç”¨ç¨‹åºè‡ªèº«

### è¿›é˜¶å­¦ä¹ è·¯çº¿ï¼ˆä¸ºä½ åç»­è¯¾ç¨‹é“ºè·¯ï¼‰
- å£³ / åè°ƒè¯•
UPXå’Œisdebugger
- æ··æ·† / è™šæ‹Ÿæœº
ç®€å•çš„vmè™šæ‹Ÿæœºå’Œollvmæ§åˆ¶æµå¹³å¦åŒ–
- Malware / å®æˆ˜é€†å‘